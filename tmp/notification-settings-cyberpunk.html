<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SYS.CONFIG // NTF.04 — NOTIFICATIONS</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Rajdhani:wght@400;500;600;700&family=Orbitron:wght@400;700;900&display=swap');

  :root {
    --primary: #00ff88;
    --primary-dim: rgba(0, 255, 136, 0.15);
    --primary-glow: rgba(0, 255, 136, 0.4);
    --bg: #060a0f;
    --bg2: #0a1018;
    --bg3: #0d1520;
    --border: rgba(0, 255, 136, 0.2);
    --border-strong: rgba(0, 255, 136, 0.5);
    --text-dim: rgba(160, 200, 180, 0.5);
    --text-mid: rgba(160, 200, 180, 0.8);
    --text: #c8e8d8;
    --red: #ff3366;
    --amber: #ffaa00;
    --cyan: #00ccff;
    --font-mono: 'Share Tech Mono', monospace;
    --font-ui: 'Rajdhani', sans-serif;
    --font-display: 'Orbitron', monospace;
  }

  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: var(--font-ui);
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* ── GRID BG ── */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image:
      linear-gradient(rgba(0,255,136,0.03) 1px, transparent 1px),
      linear-gradient(90deg, rgba(0,255,136,0.03) 1px, transparent 1px);
    background-size: 40px 40px;
    pointer-events: none;
    z-index: 0;
  }

  /* ── SCAN LINE ── */
  body::after {
    content: '';
    position: fixed;
    top: -100%;
    left: 0;
    right: 0;
    height: 200px;
    background: linear-gradient(transparent, rgba(0,255,136,0.015) 50%, transparent);
    animation: scanline 8s linear infinite;
    pointer-events: none;
    z-index: 0;
  }

  @keyframes scanline {
    0% { top: -200px; }
    100% { top: 100vh; }
  }

  /* ── LAYOUT ── */
  .wrapper {
    position: relative;
    z-index: 1;
    max-width: 760px;
    margin: 0 auto;
    padding: 32px 24px;
  }

  /* ── BREADCRUMB ── */
  .breadcrumb {
    font-family: var(--font-mono);
    font-size: 10px;
    color: var(--text-dim);
    letter-spacing: 0.15em;
    margin-bottom: 28px;
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .breadcrumb span { color: var(--primary); }
  .breadcrumb .sep { opacity: 0.4; }

  /* ── HEADER ── */
  .page-header {
    display: flex;
    align-items: flex-start;
    gap: 20px;
    margin-bottom: 36px;
    position: relative;
  }

  .icon-hex {
    position: relative;
    flex-shrink: 0;
  }

  .icon-hex-inner {
    width: 64px;
    height: 64px;
    background: var(--primary-dim);
    border: 1.5px solid var(--border-strong);
    display: flex;
    align-items: center;
    justify-content: center;
    clip-path: polygon(50% 0%, 95% 25%, 95% 75%, 50% 100%, 5% 75%, 5% 25%);
    animation: hex-pulse 3s ease-in-out infinite;
  }

  @keyframes hex-pulse {
    0%, 100% { box-shadow: 0 0 12px var(--primary-glow); }
    50% { box-shadow: 0 0 28px var(--primary-glow), 0 0 50px rgba(0,255,136,0.15); }
  }

  .icon-hex svg { width: 28px; height: 28px; }

  .header-text { flex: 1; }

  .sys-code {
    font-family: var(--font-mono);
    font-size: 10px;
    color: var(--primary);
    letter-spacing: 0.2em;
    margin-bottom: 4px;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .sys-code::before {
    content: '▶';
    font-size: 8px;
    animation: blink 1.2s step-end infinite;
  }

  @keyframes blink {
    0%, 100% { opacity: 1; }
    50% { opacity: 0; }
  }

  .page-title {
    font-family: var(--font-display);
    font-size: clamp(20px, 4vw, 28px);
    font-weight: 900;
    letter-spacing: 0.08em;
    color: var(--primary);
    text-shadow: 0 0 20px var(--primary-glow);
    line-height: 1;
    margin-bottom: 8px;
  }

  .page-subtitle {
    font-size: 13px;
    color: var(--text-dim);
    font-weight: 500;
    letter-spacing: 0.05em;
  }

  .status-badge {
    font-family: var(--font-mono);
    font-size: 9px;
    border: 1px solid var(--primary);
    color: var(--primary);
    padding: 3px 8px;
    letter-spacing: 0.15em;
    background: var(--primary-dim);
    align-self: flex-start;
    margin-top: 4px;
    position: relative;
    overflow: hidden;
  }

  .status-badge::before {
    content: '';
    position: absolute;
    top: 0; left: -100%;
    width: 50%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(0,255,136,0.2), transparent);
    animation: shimmer 2.5s ease-in-out infinite;
  }

  @keyframes shimmer {
    0% { left: -100%; }
    100% { left: 200%; }
  }

  /* ── SEPARATOR ── */
  .cyber-sep {
    height: 1px;
    background: linear-gradient(90deg, transparent, var(--primary), rgba(0,255,136,0.3) 60%, transparent);
    margin-bottom: 28px;
    position: relative;
  }

  .cyber-sep::before {
    content: '◆';
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    color: var(--primary);
    font-size: 8px;
    background: var(--bg);
    padding: 0 8px;
  }

  /* ── DATA PANEL ── */
  .data-panel {
    border: 1px solid var(--border);
    background: linear-gradient(135deg, rgba(13,21,32,0.95), rgba(6,10,15,0.98));
    position: relative;
    margin-bottom: 16px;
    transition: border-color 0.3s;
  }

  .data-panel:hover { border-color: rgba(0,255,136,0.35); }

  /* Corner brackets */
  .data-panel::before, .data-panel::after {
    content: '';
    position: absolute;
    width: 12px; height: 12px;
    border-color: var(--primary);
    border-style: solid;
    opacity: 0.6;
  }
  .data-panel::before { top: -1px; left: -1px; border-width: 2px 0 0 2px; }
  .data-panel::after { bottom: -1px; right: -1px; border-width: 0 2px 2px 0; }

  .panel-header {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 16px 20px;
    border-bottom: 1px solid var(--border);
    background: rgba(0,255,136,0.03);
  }

  .panel-code {
    font-family: var(--font-mono);
    font-size: 9px;
    color: var(--primary);
    letter-spacing: 0.15em;
    opacity: 0.7;
    min-width: 70px;
  }

  .panel-title {
    font-family: var(--font-display);
    font-size: 13px;
    font-weight: 700;
    letter-spacing: 0.12em;
    color: var(--primary);
    flex: 1;
  }

  .panel-status {
    font-family: var(--font-mono);
    font-size: 9px;
    color: var(--text-dim);
    letter-spacing: 0.1em;
  }

  .panel-body { padding: 0 20px; }

  /* ── SETTING ROW ── */
  .setting-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 18px 0;
    border-bottom: 1px solid rgba(0,255,136,0.06);
    gap: 16px;
    cursor: pointer;
    transition: background 0.2s;
    margin: 0 -20px;
    padding-left: 20px;
    padding-right: 20px;
    position: relative;
    overflow: hidden;
  }

  .setting-row:last-child { border-bottom: none; }

  .setting-row::before {
    content: '';
    position: absolute;
    left: 0; top: 0; bottom: 0;
    width: 3px;
    background: var(--primary);
    transform: scaleY(0);
    transition: transform 0.2s;
    transform-origin: center;
  }

  .setting-row:hover::before { transform: scaleY(1); }

  .setting-row:hover { background: rgba(0,255,136,0.03); }

  .row-left {
    display: flex;
    align-items: flex-start;
    gap: 14px;
    flex: 1;
    min-width: 0;
  }

  .row-icon-wrap {
    width: 36px;
    height: 36px;
    border: 1px solid var(--border);
    background: var(--primary-dim);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    transition: all 0.3s;
    clip-path: polygon(8px 0%, 100% 0%, 100% calc(100% - 8px), calc(100% - 8px) 100%, 0% 100%, 0% 8px);
  }

  .setting-row:hover .row-icon-wrap {
    background: rgba(0,255,136,0.25);
    border-color: var(--primary);
    box-shadow: 0 0 12px var(--primary-glow);
  }

  .row-icon-wrap svg { width: 16px; height: 16px; color: var(--primary); }

  .row-text { flex: 1; min-width: 0; }

  .row-label {
    font-family: var(--font-ui);
    font-size: 14px;
    font-weight: 700;
    letter-spacing: 0.08em;
    color: var(--text);
    text-transform: uppercase;
    line-height: 1;
    margin-bottom: 5px;
  }

  .row-desc {
    font-size: 11px;
    color: var(--text-dim);
    letter-spacing: 0.04em;
    line-height: 1.4;
    font-weight: 400;
  }

  /* ── CYBER TOGGLE ── */
  .cyber-toggle {
    position: relative;
    width: 52px;
    height: 26px;
    flex-shrink: 0;
    cursor: pointer;
  }

  .cyber-toggle input {
    opacity: 0;
    width: 0; height: 0;
    position: absolute;
  }

  .toggle-track {
    position: absolute;
    inset: 0;
    background: rgba(0,255,136,0.08);
    border: 1px solid rgba(0,255,136,0.25);
    transition: all 0.3s;
    clip-path: polygon(6px 0%, 100% 0%, calc(100% - 6px) 100%, 0% 100%);
  }

  .toggle-thumb {
    position: absolute;
    top: 3px;
    left: 4px;
    width: 18px;
    height: 18px;
    background: rgba(0,255,136,0.3);
    border: 1px solid rgba(0,255,136,0.5);
    transition: all 0.3s;
    clip-path: polygon(4px 0%, 100% 0%, calc(100% - 4px) 100%, 0% 100%);
  }

  .cyber-toggle input:checked ~ .toggle-track {
    background: rgba(0,255,136,0.2);
    border-color: var(--primary);
    box-shadow: 0 0 10px var(--primary-glow), inset 0 0 8px rgba(0,255,136,0.1);
  }

  .cyber-toggle input:checked ~ .toggle-track .toggle-thumb {
    left: 26px;
    background: var(--primary);
    border-color: var(--primary);
    box-shadow: 0 0 8px var(--primary-glow);
  }

  /* Status indicator per row */
  .row-status {
    font-family: var(--font-mono);
    font-size: 9px;
    min-width: 50px;
    text-align: right;
    letter-spacing: 0.1em;
    transition: all 0.3s;
  }

  /* ── SPECIAL ROWS ── */
  .row-focus .row-icon-wrap { border-color: rgba(255, 170, 0, 0.4); background: rgba(255,170,0,0.1); }
  .row-focus .row-icon-wrap svg { color: var(--amber); }
  .row-focus .row-label { color: var(--amber); }
  .row-focus .toggle-track { border-color: rgba(255,170,0,0.25); }

  .cyber-toggle.amber input:checked ~ .toggle-track {
    background: rgba(255,170,0,0.2);
    border-color: var(--amber);
    box-shadow: 0 0 10px rgba(255,170,0,0.4), inset 0 0 8px rgba(255,170,0,0.1);
  }
  .cyber-toggle.amber input:checked ~ .toggle-track .toggle-thumb {
    left: 26px;
    background: var(--amber);
    border-color: var(--amber);
    box-shadow: 0 0 8px rgba(255,170,0,0.4);
  }

  /* ── FOCUS MODE ALERT ── */
  .focus-alert {
    margin: 0 -20px;
    padding: 12px 20px;
    background: rgba(255,170,0,0.07);
    border-top: 1px solid rgba(255,170,0,0.2);
    display: none;
    gap: 10px;
    align-items: center;
  }

  .focus-alert.active { display: flex; }

  .focus-alert-icon {
    width: 20px; height: 20px;
    animation: focus-pulse 1s ease-in-out infinite;
  }

  @keyframes focus-pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.4; }
  }

  .focus-alert-text {
    font-family: var(--font-mono);
    font-size: 10px;
    color: var(--amber);
    letter-spacing: 0.1em;
  }

  /* ── PANEL FOOTER ── */
  .panel-footer {
    padding: 12px 20px;
    border-top: 1px solid var(--border);
    background: rgba(0,255,136,0.02);
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  .footer-stats {
    font-family: var(--font-mono);
    font-size: 9px;
    color: var(--text-dim);
    letter-spacing: 0.1em;
    display: flex;
    gap: 16px;
  }

  .footer-stats b { color: var(--primary); }

  .footer-save {
    font-family: var(--font-mono);
    font-size: 9px;
    color: var(--text-dim);
    letter-spacing: 0.1em;
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .save-dot {
    width: 6px; height: 6px;
    border-radius: 50%;
    background: var(--primary);
    box-shadow: 0 0 6px var(--primary-glow);
    animation: blink 1s step-end infinite;
    display: none;
  }

  .save-dot.active { display: block; }

  /* ── TERMINAL LOG ── */
  .terminal {
    border: 1px solid var(--border);
    background: rgba(0,0,0,0.6);
    padding: 14px 16px;
    font-family: var(--font-mono);
    font-size: 10px;
    color: var(--text-dim);
    letter-spacing: 0.08em;
    line-height: 1.8;
    max-height: 100px;
    overflow: hidden;
    position: relative;
  }

  .terminal::before {
    content: 'SYSTEM LOG //';
    display: block;
    color: var(--primary);
    margin-bottom: 6px;
    font-size: 9px;
    opacity: 0.7;
  }

  .log-line { opacity: 0; animation: log-in 0.3s forwards; }
  .log-line.ok::before { content: '✓ '; color: var(--primary); }
  .log-line.warn::before { content: '⚠ '; color: var(--amber); }
  .log-line.info::before { content: '» '; color: var(--cyan); }

  @keyframes log-in {
    from { opacity: 0; transform: translateX(-4px); }
    to { opacity: 1; transform: none; }
  }

  /* ── RESPONSIVENESS ── */
  @media (max-width: 480px) {
    .row-desc { display: none; }
    .row-status { display: none; }
    .page-title { font-size: 18px; }
  }
</style>
</head>
<body>
<div class="wrapper">

  <!-- BREADCRUMB -->
  <div class="breadcrumb">
    ROOT <span class="sep">//</span>
    USER_SETTINGS <span class="sep">//</span>
    <span>NTF.04</span>
  </div>

  <!-- HEADER -->
  <div class="page-header">
    <div class="icon-hex">
      <div class="icon-hex-inner">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" style="color:var(--primary)">
          <path d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"/>
        </svg>
      </div>
    </div>
    <div class="header-text">
      <div class="sys-code">NTF.04 // SYSTEM_CONFIG</div>
      <h1 class="page-title">NOTIFICATIONS</h1>
      <p class="page-subtitle">Contrôle des flux d'alerte système</p>
      <div class="status-badge">[ CONNECTED ]</div>
    </div>
  </div>

  <div class="cyber-sep"></div>

  <!-- PANEL 1: CATEGORIES -->
  <div class="data-panel">
    <div class="panel-header">
      <span class="panel-code">MODULE_01</span>
      <span class="panel-title">FLUX D'ALERTES</span>
      <span class="panel-status" id="active-count">4/4 ACTIFS</span>
    </div>
    <div class="panel-body">

      <!-- Row: System -->
      <div class="setting-row" onclick="toggle('system')">
        <div class="row-left">
          <div class="row-icon-wrap">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
          </div>
          <div class="row-text">
            <div class="row-label">System Alerts</div>
            <div class="row-desc">Updates, patch notes, avis système</div>
          </div>
        </div>
        <span class="row-status" id="status-system" style="color:var(--primary)">ENABLED</span>
        <label class="cyber-toggle" onclick="event.stopPropagation()">
          <input type="checkbox" id="toggle-system" checked onchange="syncToggle('system')">
          <div class="toggle-track">
            <div class="toggle-thumb"></div>
          </div>
        </label>
      </div>

      <!-- Row: Progress -->
      <div class="setting-row" onclick="toggle('progress')">
        <div class="row-left">
          <div class="row-icon-wrap">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 3v18h18"/><path d="M18.7 8l-5.1 5.2-2.8-2.7L7 14.3"/></svg>
          </div>
          <div class="row-text">
            <div class="row-label">Progress & XP</div>
            <div class="row-desc">Succès, objectifs, streaks, milestones</div>
          </div>
        </div>
        <span class="row-status" id="status-progress" style="color:var(--primary)">ENABLED</span>
        <label class="cyber-toggle" onclick="event.stopPropagation()">
          <input type="checkbox" id="toggle-progress" checked onchange="syncToggle('progress')">
          <div class="toggle-track">
            <div class="toggle-thumb"></div>
          </div>
        </label>
      </div>

      <!-- Row: Social -->
      <div class="setting-row" onclick="toggle('social')">
        <div class="row-left">
          <div class="row-icon-wrap">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"/></svg>
          </div>
          <div class="row-text">
            <div class="row-label">Social</div>
            <div class="row-desc">Messages, réponses, mentions</div>
          </div>
        </div>
        <span class="row-status" id="status-social" style="color:var(--primary)">ENABLED</span>
        <label class="cyber-toggle" onclick="event.stopPropagation()">
          <input type="checkbox" id="toggle-social" checked onchange="syncToggle('social')">
          <div class="toggle-track">
            <div class="toggle-thumb"></div>
          </div>
        </label>
      </div>

      <!-- Row: Marketing -->
      <div class="setting-row" onclick="toggle('marketing')">
        <div class="row-left">
          <div class="row-icon-wrap">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 12V22H4V12"/><path d="M22 7H2v5h20V7z"/><path d="M12 22V7"/><path d="M12 7H7.5a2.5 2.5 0 010-5C11 2 12 7 12 7z"/><path d="M12 7h4.5a2.5 2.5 0 000-5C13 2 12 7 12 7z"/></svg>
          </div>
          <div class="row-text">
            <div class="row-label">Marketing & Promos</div>
            <div class="row-desc">Codes promo, cadeaux, offres spéciales</div>
          </div>
        </div>
        <span class="row-status" id="status-marketing" style="color:var(--primary)">ENABLED</span>
        <label class="cyber-toggle" onclick="event.stopPropagation()">
          <input type="checkbox" id="toggle-marketing" checked onchange="syncToggle('marketing')">
          <div class="toggle-track">
            <div class="toggle-thumb"></div>
          </div>
        </label>
      </div>

    </div>
    <div class="panel-footer">
      <div class="footer-stats">
        <span>ACTIFS: <b id="stat-active">4</b></span>
        <span>TOTAL: <b>4</b></span>
      </div>
      <div class="footer-save">
        <div class="save-dot" id="save-dot-1"></div>
        <span id="save-text-1">CONFIG SYNC'D</span>
      </div>
    </div>
  </div>

  <!-- PANEL 2: SYSTEM CONTROLS -->
  <div class="data-panel">
    <div class="panel-header">
      <span class="panel-code">MODULE_02</span>
      <span class="panel-title">CONTRÔLES SYSTÈME</span>
    </div>
    <div class="panel-body">

      <!-- Push -->
      <div class="setting-row" onclick="toggle('push')">
        <div class="row-left">
          <div class="row-icon-wrap" style="border-color:rgba(0,204,255,0.4);background:rgba(0,204,255,0.1)">
            <svg viewBox="0 0 24 24" fill="none" stroke="var(--cyan)" stroke-width="2"><path d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 01-3.46 0"/></svg>
          </div>
          <div class="row-text">
            <div class="row-label" style="color:var(--cyan)">Push Notifications</div>
            <div class="row-desc">Alertes navigateur en temps réel</div>
          </div>
        </div>
        <span class="row-status" id="status-push" style="color:var(--cyan)">ENABLED</span>
        <label class="cyber-toggle" onclick="event.stopPropagation()" style="--primary:var(--cyan);--primary-glow:rgba(0,204,255,0.4)">
          <input type="checkbox" id="toggle-push" checked onchange="syncToggle('push')">
          <div class="toggle-track" style="border-color:rgba(0,204,255,0.25)">
            <div class="toggle-thumb" style="background:rgba(0,204,255,0.3);border-color:rgba(0,204,255,0.5)"></div>
          </div>
        </label>
      </div>

      <!-- Focus Mode -->
      <div class="setting-row row-focus" onclick="toggle('focus')">
        <div class="row-left">
          <div class="row-icon-wrap">
            <svg viewBox="0 0 24 24" fill="none" stroke="var(--amber)" stroke-width="2" style="color:var(--amber)"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
          </div>
          <div class="row-text">
            <div class="row-label">Focus Mode</div>
            <div class="row-desc">Silence toutes les alertes temporairement</div>
          </div>
        </div>
        <span class="row-status" id="status-focus" style="color:var(--text-dim)">DISABLED</span>
        <label class="cyber-toggle amber" onclick="event.stopPropagation()">
          <input type="checkbox" id="toggle-focus" onchange="syncToggle('focus');toggleFocusAlert()">
          <div class="toggle-track">
            <div class="toggle-thumb"></div>
          </div>
        </label>
      </div>

      <!-- Focus Mode Alert -->
      <div class="focus-alert" id="focus-alert">
        <svg class="focus-alert-icon" viewBox="0 0 24 24" fill="none" stroke="var(--amber)" stroke-width="2" width="20" height="20"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
        <span class="focus-alert-text">⚠ FOCUS MODE ACTIF — TOUTES LES ALERTES SONT SILENCIÉES</span>
      </div>

    </div>
    <div class="panel-footer">
      <div class="footer-stats">
        <span>PUSH: <b id="stat-push" style="color:var(--cyan)">ON</b></span>
        <span>FOCUS: <b id="stat-focus" style="color:var(--text-dim)">OFF</b></span>
      </div>
      <div class="footer-save">
        <div class="save-dot" id="save-dot-2"></div>
        <span id="save-text-2">CONFIG SYNC'D</span>
      </div>
    </div>
  </div>

  <!-- TERMINAL LOG -->
  <div class="terminal" id="terminal">
    <div class="log-line info" style="animation-delay:0.1s">NOTIFICATION SETTINGS LOADED</div>
    <div class="log-line ok" style="animation-delay:0.3s">ALL CHANNELS ACTIVE — 4/4</div>
    <div class="log-line info" style="animation-delay:0.5s">PUSH SERVICE: CONNECTED</div>
  </div>

</div>

<script>
  const states = {
    system: true, progress: true, social: true, marketing: true,
    push: true, focus: false
  };

  const colors = { push: 'var(--cyan)', focus: 'var(--amber)' };

  function toggle(key) {
    const el = document.getElementById('toggle-' + key);
    el.checked = !el.checked;
    syncToggle(key);
    if (key === 'focus') toggleFocusAlert();
  }

  function syncToggle(key) {
    const el = document.getElementById('toggle-' + key);
    states[key] = el.checked;
    updateStatus(key);
    updateFooter();
    markUnsaved(key);
    logChange(key, el.checked);
  }

  function updateStatus(key) {
    const statusEl = document.getElementById('status-' + key);
    if (!statusEl) return;
    const isOn = states[key];
    const color = colors[key] || (isOn ? 'var(--primary)' : 'var(--text-dim)');
    statusEl.textContent = isOn ? 'ENABLED' : 'DISABLED';
    statusEl.style.color = isOn ? color : 'var(--text-dim)';
  }

  function updateFooter() {
    const keys = ['system','progress','social','marketing'];
    const active = keys.filter(k => states[k]).length;
    document.getElementById('stat-active').textContent = active;
    document.getElementById('active-count').textContent = active + '/4 ACTIFS';
    document.getElementById('active-count').style.color = active < 2 ? 'var(--red)' : active < 4 ? 'var(--amber)' : 'var(--text-dim)';

    const pushEl = document.getElementById('stat-push');
    pushEl.textContent = states.push ? 'ON' : 'OFF';
    pushEl.style.color = states.push ? 'var(--cyan)' : 'var(--text-dim)';

    const focusEl = document.getElementById('stat-focus');
    focusEl.textContent = states.focus ? 'ON' : 'OFF';
    focusEl.style.color = states.focus ? 'var(--amber)' : 'var(--text-dim)';
  }

  function toggleFocusAlert() {
    const alert = document.getElementById('focus-alert');
    if (states.focus) alert.classList.add('active');
    else alert.classList.remove('active');
  }

  function markUnsaved(key) {
    const panel = ['system','progress','social','marketing'].includes(key) ? 1 : 2;
    const dot = document.getElementById('save-dot-' + panel);
    const txt = document.getElementById('save-text-' + panel);
    dot.classList.add('active');
    txt.textContent = 'PENDING SYNC...';
    txt.style.color = 'var(--amber)';
    clearTimeout(dot._timer);
    dot._timer = setTimeout(() => {
      dot.classList.remove('active');
      txt.textContent = 'CONFIG SYNC\'D';
      txt.style.color = 'var(--text-dim)';
    }, 2000);
  }

  function logChange(key, val) {
    const terminal = document.getElementById('terminal');
    const line = document.createElement('div');
    line.className = 'log-line ' + (val ? 'ok' : 'warn');
    const labels = {
      system: 'SYSTEM_ALERTS', progress: 'PROGRESS_ALERTS',
      social: 'SOCIAL_ALERTS', marketing: 'MARKETING_ALERTS',
      push: 'PUSH_SERVICE', focus: 'FOCUS_MODE'
    };
    line.textContent = (labels[key] || key.toUpperCase()) + ': ' + (val ? 'ENABLED' : 'DISABLED');
    terminal.appendChild(line);
    // keep only last 5 lines (+ header ::before)
    const lines = terminal.querySelectorAll('.log-line');
    if (lines.length > 5) lines[0].remove();
    terminal.scrollTop = terminal.scrollHeight;
  }
</script>
</body>
</html>
